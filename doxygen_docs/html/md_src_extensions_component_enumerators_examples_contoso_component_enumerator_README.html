<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Device Update for IotHub: How to register components with Device Update: Contoso Virtual Vacuum Component Enumerator example</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Device Update for IotHub
   &#160;<span id="projectnumber">1.0.1</span>
   </div>
   <div id="projectbrief">Device Update for IoTHub delivers client update from the Device Update for IotHub service.</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">How to register components with Device Update: Contoso Virtual Vacuum Component Enumerator example </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>This sections shows a sample implementation of the Contoso Virtual Vacuum Components Enumerator that you can reference to implement a custom Components Enumerator for your IoT devices. A component is a sub-device-level identity that has a composition relationship with the host device.</p>
<h1><a class="anchor" id="autotoc_md62"></a>
What is Contoso Virtual Vacuum</h1>
<p>A Contoso Virtual-Vacuum is a virtual IoT device that we use to demonstrate the <b>Proxy Update</b> feature. <br  />
</p>
<p><b>Proxy Update</b> enables updating multiple components on the same IoT device or multiple sensors connected to the IoT device with a single over-the-air deployment. Proxy updates also supports an install order when updating components and a multi-step update process with pre-install, install, post-install capabilities. Use cases where proxy updates is applicable include:</p>
<ul>
<li>Targeting specific update files to different partitions on the device.</li>
<li>Targeting specific update files to different apps/components on the device</li>
<li>Targeting specific update files to sensors connected to IoT devices over a network protocol (e.g., USB, CANbus etc.) <br  />
</li>
</ul>
<p>The Device Update Agent (running on the host device) can send each update to a specific <b>component</b> or to a <b>group of components</b> of the same hardware class (i.e. requiring the same software or firmware update). <br  />
</p>
<h1><a class="anchor" id="autotoc_md63"></a>
Virtual-Vacuum Components</h1>
<p>For this demonstration, the Contoso Virtual Vacuum consists of five 'logical' components: <br  />
</p>
<ul>
<li>Host Firmware</li>
<li>Host Boot File System</li>
<li>Host Root File System</li>
<li>Three Motors (Left Wheel, Right Wheel, and Vacuum)</li>
<li>Two Cameras (Front and Rear)</li>
</ul>
<p><b>Figure 1</b> - Contoso Virtual Vacuum Components Diagram</p>
<p><object type="image/svg+xml" data="../contoso_component_enumerator/assets/contoso-virtual-vacuum-components-diagram.svg" style="pointer-events: none;">Contoso Virtual-Vacuum Components Diagram</object></p>
<p>We use the following directory structure to simulates those components mentioned above.</p>
<div class="fragment"><div class="line">/usr/local/contoso-devices/vacuum-1/hostfw</div>
<div class="line">/usr/local/contoso-devices/vacuum-1/bootfs</div>
<div class="line">/usr/local/contoso-devices/vacuum-1/rootfs</div>
<div class="line">/usr/local/contoso-devices/vacuum-1/motors/0   /* left motor */</div>
<div class="line">/usr/local/contoso-devices/vacuum-1/motors/1   /* right motor */</div>
<div class="line">/usr/local/contoso-devices/vacuum-1/motors/2   /* vacuum motor */</div>
<div class="line">/usr/local/contoso-devices/vacuum-1/cameras/0  /* front camera */</div>
<div class="line">/usr/local/contoso-devices/vacuum-1/cameras/1  /* rear camera */</div>
</div><!-- fragment --><p>Each component's directory contains a JSON file that stores a mock software version number of each component. These file are <code>firmware.json</code> or <code>diskimage.json</code>. <br  />
</p>
<blockquote class="doxtable">
<p><b>Note:</b> For this demo, to update the components' firmware, we will copy a <code>firmware.json</code> or <code>diskimage.json</code> (update payload) to &lsquo;targeted components&rsquo; directory`. </p>
</blockquote>
<p>Example <code>firmware.json</code> file:</p>
<div class="fragment"><div class="line">{</div>
<div class="line">    &quot;version&quot;: &quot;0.5&quot;,</div>
<div class="line">    &quot;description&quot;: &quot;This component is generated for testing purposes.&quot;</div>
<div class="line">}</div>
</div><!-- fragment --><blockquote class="doxtable">
<p><b>Note:</b> The Contoso Virtual-Vacuum doesn't provide any other functionality besides containing software or firmware versions for Proxy Update demonstration purposes. <br  />
 </p>
</blockquote>
<h1><a class="anchor" id="autotoc_md64"></a>
What is a Component Enumerator?</h1>
<p>A <b>Component Enumerator</b> is a <b>Device Update Agent Extension</b> that provides information about every <b>component</b> that you need to over-the-air update via a host device's IoT Hub connection. <br  />
</p>
<p>The Device Update Agent is device and component agnostic. By itself, Device Update Agent doesn't know anything about components that resides on or are connected to a host device at the time of the update. <br  />
</p>
<p>To enable Proxy Updates, device builders must identify all components that can be updated on the device and assign a unique name to each component. Also, group name can be assigned to components of the same hardware class, so that, the same update can be installed onto all components in the same group. <br  />
</p>
<p>After doing this the Step Handler can install and apply the update to the correct component(s). <br  />
</p>
<p><b>Figure 2</b> - Proxy Update Flow Diagram</p>
<p><object type="image/svg+xml" data="../contoso_component_enumerator/assets/contoso-virtual-vacuum-update-flow.svg" style="pointer-events: none;">Contoso Virtual-Vacuum Update Flow</object></p>
<ul>
<li><b>Device Builder responsibilities</b><ul>
<li>Design and build the device.</li>
<li>Integrate Device Update Agent and its dependencies.</li>
<li>Implement device-specific <b>Component Enumerator Extension</b> and register with DU Agent.</li>
<li>The <b>Component Enumerator</b> leverage components information from a component inventory or configuration file. Then augment static (DU required) component data with the dynamic data (e.g., firmware version, connection status, hardware id, etc.)</li>
<li>Create a Proxy Update containing one or more Child Updates that target one or more components on (or connected to) the device.</li>
<li>Sent the update to their Solution Operator</li>
</ul>
</li>
<li><b>Solution Operator</b><ul>
<li>Import the update (and manifest) to the Device Update Service</li>
<li>Deploy the update to a group of devices</li>
</ul>
</li>
<li><b>Device Update Agent</b><ul>
<li>Receives update information from Azure IoT Hub (via Device Twin or Module Twin)</li>
<li>Invokes <b>Steps Handler</b> to process the Proxy Update intended for one or more components on the device<ul>
<li>For each Child Update (in this example, there are 2 updates, <code>host-fw-1.1</code> and <code>motors-fw-1.1</code>), Parent <b>Steps Handler</b> invokes Child <b>Steps Handler</b> to enumerate all components that match the <b>Compatibilities</b> properties specified in Child Update Manifest file. Next the handler downloads, installs and applies the Child Update to all targeted components.</li>
<li>To get the matching components, the Child Update will call a <code>SelectComponents</code> API provided by the <b>Component Enumerator</b>. <br  />
**Note:** If there is no matching components, the Child Update will be skipped.</li>
</ul>
</li>
<li>Collects all update results from Parent and Child Update(s) and reports it to the Azure IoT Hub.</li>
</ul>
</li>
<li>Child <b>Steps Handler</b><ul>
<li>Iterate through a list of <b>instances of component</b> that are compatible with the <b>Child Update</b> content.</li>
<li>See ../../../../extensions/update_manifest_handlers/steps_handler/README.md "Steps Handler" for more information.</li>
</ul>
</li>
<li><b>SWUpdate Installer</b> and <b>Motors Firmware Installer</b><ul>
<li>See ../../../../../docs/agent-reference/how-to-implement-custom-update-handler.md "How To Implement Custom Step Handler" for more details.</li>
</ul>
</li>
</ul>
<h1><a class="anchor" id="autotoc_md65"></a>
How To Implement Component Enumerator for Device Update Agent (C language)</h1>
<h2><a class="anchor" id="autotoc_md66"></a>
Requirements</h2>
<ul>
<li>Implements all APIs declared in <a href="../../extension_manager/inc/aduc/../../../../inc/aduc/component_enumerator_extension.hpp">component_enumerator_extension.hpp</a></li>
</ul>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Function </th><th class="markdownTableHeadNone">Arguments </th><th class="markdownTableHeadNone">Returns  </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>char* GetAllComponents()</code> </td><td class="markdownTableBodyNone">None </td><td class="markdownTableBodyNone">A JSON string contains an array of <b>all</b> <a href="./README.md#componentinfo">ComponentInfo</a><br  />
<br  />
See <a href="./README.md#example-return-values">Example Return Values</a> for more info.  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>char* SelectComponents(char* selector)</code> </td><td class="markdownTableBodyNone">A JSON string containing one or more name-value pair(s) use for selecting update target component(s) </td><td class="markdownTableBodyNone">A JSON string contains an array of <a href="./README.md#componentinfo">ComponentInfo</a><br  />
<br  />
See <a href="./README.md#example-return-values">Example Return Values</a> for more info.  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>void FreeComponentsDataString(char* string)</code> </td><td class="markdownTableBodyNone">A pointer to string buffer previously returned by <code>GetAllComponents</code> or <code>SelectComponents</code> functions. </td><td class="markdownTableBodyNone">None  </td></tr>
</table>
<h2><a class="anchor" id="autotoc_md67"></a>
ComponentInfo</h2>
<p>The ComponentInfo JSON string must include following required properties:</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Name </th><th class="markdownTableHeadNone">Type </th><th class="markdownTableHeadNone">Description  </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">id </td><td class="markdownTableBodyNone">string </td><td class="markdownTableBodyNone">A component's unique id (device scope)<br  />
<br  />
e.g., hardware's serial number, disk partition id, unique file path of the component, etc.  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">name </td><td class="markdownTableBodyNone">string </td><td class="markdownTableBodyNone">A component's <code>logical</code> name. This is the name that a device builder assigns to a component that is available in every device of the same <code>device class</code>.<br  />
<br  />
For example, every Contoso Virtual-Vacuum device contains a motor that drives left wheel. Contoso assigned 'Left Motor' as a common (logical) name for this motore, to easily refer to this component, instead of hardware ID, which can be globally unique.  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">group </td><td class="markdownTableBodyNone">string </td><td class="markdownTableBodyNone">A group that this component belongs to.<br  />
<br  />
For example, all motors could belong to a 'motors' group.  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">manufacturer </td><td class="markdownTableBodyNone">string </td><td class="markdownTableBodyNone">For physical hardware component, this is a manufacturer or vendor name.<br  />
<br  />
For logical component, such as, disk partition or directory, this can be any device Builder's Defined value.  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">model </td><td class="markdownTableBodyNone">string </td><td class="markdownTableBodyNone">For physical hardware component, this is a model name.<br  />
<br  />
For logical component, such as, disk partition or directory, this can be any device builder's Defined value.  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">properties </td><td class="markdownTableBodyNone">object </td><td class="markdownTableBodyNone">A JSON object contain any optional device-specific properties.  </td></tr>
</table>
<h3><a class="anchor" id="autotoc_md68"></a>
Example ComponentInfo</h3>
<div class="fragment"><div class="line">{</div>
<div class="line">    &quot;id&quot;: &quot;contoso-motor-serial-00000&quot;,</div>
<div class="line">    &quot;name&quot;: &quot;left-motor&quot;,</div>
<div class="line">    &quot;group&quot;: &quot;motors&quot;,</div>
<div class="line">    &quot;manufacturer&quot;: &quot;contoso&quot;,</div>
<div class="line">    &quot;model&quot;: &quot;virtual-motor&quot;,</div>
<div class="line">    &quot;properties&quot;: {</div>
<div class="line">        &quot;path&quot;: &quot;\/usr\/local\/contoso-devices\/vacuum-1\/motors\/0&quot;,</div>
<div class="line">        &quot;firmwareDataFile&quot;: &quot;firmware.json&quot;,</div>
<div class="line">        &quot;status&quot;: &quot;connected&quot;,</div>
<div class="line">        &quot;version&quot; : &quot;motor-fw-1.0&quot;</div>
<div class="line">    }</div>
<div class="line">}</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md69"></a>
Example Return Values</h2>
<p>Following is a JSON document returned from <code>GetAllComponents</code> function *(Based on example Contoso Component Enumerator implementation)*</p>
<div class="fragment"><div class="line">{</div>
<div class="line">    &quot;components&quot;: [</div>
<div class="line">        {</div>
<div class="line">            &quot;id&quot;: &quot;hostfw&quot;,</div>
<div class="line">            &quot;name&quot;: &quot;hostfw&quot;,</div>
<div class="line">            &quot;group&quot;: &quot;firmware&quot;,</div>
<div class="line">            &quot;manufacturer&quot;: &quot;contoso&quot;,</div>
<div class="line">            &quot;model&quot;: &quot;virtual-firmware&quot;,</div>
<div class="line">            &quot;properties&quot;: {</div>
<div class="line">                &quot;path&quot;: &quot;\/usr\/local\/contoso-devices\/vacuum-1\/hostfw&quot;,</div>
<div class="line">                &quot;firmwareDataFile&quot;: &quot;firmware.json&quot;,</div>
<div class="line">                &quot;status&quot;: &quot;ok&quot;,</div>
<div class="line">                &quot;version&quot; : &quot;host-fw-1.0&quot;</div>
<div class="line">            }</div>
<div class="line">        },</div>
<div class="line">        {</div>
<div class="line">            &quot;id&quot;: &quot;bootfs&quot;,</div>
<div class="line">            &quot;name&quot;: &quot;bootfs&quot;,</div>
<div class="line">            &quot;group&quot;: &quot;boot-image&quot;,</div>
<div class="line">            &quot;manufacturer&quot;: &quot;contoso&quot;,</div>
<div class="line">            &quot;model&quot;: &quot;virtual-disk&quot;,</div>
<div class="line">            &quot;properties&quot;: {</div>
<div class="line">                &quot;path&quot;: &quot;\/usr\/local\/contoso-devices\/vacuum-1\/bootfs&quot;,</div>
<div class="line">                &quot;firmwareDataFile&quot;: &quot;diskimage.json&quot;,</div>
<div class="line">                &quot;status&quot;: &quot;ok&quot;,</div>
<div class="line">                &quot;version&quot; : &quot;boot-fs-1.0&quot;</div>
<div class="line">            }</div>
<div class="line">        },</div>
<div class="line">        {</div>
<div class="line">            &quot;id&quot;: &quot;rootfs&quot;,</div>
<div class="line">            &quot;name&quot;: &quot;rootfs&quot;,</div>
<div class="line">            &quot;group&quot;: &quot;os-image&quot;,</div>
<div class="line">            &quot;manufacturer&quot;: &quot;contoso&quot;,</div>
<div class="line">            &quot;model&quot;: &quot;virtual-os&quot;,</div>
<div class="line">            &quot;properties&quot;: {</div>
<div class="line">                &quot;path&quot;: &quot;\/usr\/local\/contoso-devices\/vacuum-1\/rootfs&quot;,</div>
<div class="line">                &quot;firmwareDataFile&quot;: &quot;diskimage.json&quot;,</div>
<div class="line">                &quot;status&quot;: &quot;ok&quot;,</div>
<div class="line">                &quot;version&quot; : &quot;root-fs-1.0&quot;</div>
<div class="line">            }</div>
<div class="line">        },</div>
<div class="line">        {</div>
<div class="line">            &quot;id&quot;: &quot;contoso-motor-serial-00000&quot;,</div>
<div class="line">            &quot;name&quot;: &quot;left-motor&quot;,</div>
<div class="line">            &quot;group&quot;: &quot;motors&quot;,</div>
<div class="line">            &quot;manufacturer&quot;: &quot;contoso&quot;,</div>
<div class="line">            &quot;model&quot;: &quot;virtual-motor&quot;,</div>
<div class="line">            &quot;properties&quot;: {</div>
<div class="line">                &quot;path&quot;: &quot;\/usr\/local\/contoso-devices\/vacuum-1\/motors\/0&quot;,</div>
<div class="line">                &quot;firmwareDataFile&quot;: &quot;firmware.json&quot;,</div>
<div class="line">                &quot;status&quot;: &quot;ok&quot;,</div>
<div class="line">                &quot;version&quot; : &quot;motor-fw-1.0&quot;</div>
<div class="line">            }</div>
<div class="line">        },</div>
<div class="line">        {</div>
<div class="line">            &quot;id&quot;: &quot;contoso-motor-serial-00001&quot;,</div>
<div class="line">            &quot;name&quot;: &quot;right-motor&quot;,</div>
<div class="line">            &quot;group&quot;: &quot;motors&quot;,</div>
<div class="line">            &quot;manufacturer&quot;: &quot;contoso&quot;,</div>
<div class="line">            &quot;model&quot;: &quot;virtual-motor&quot;,</div>
<div class="line">            &quot;properties&quot;: {</div>
<div class="line">                &quot;path&quot;: &quot;\/usr\/local\/contoso-devices\/vacuum-1\/motors\/1&quot;,</div>
<div class="line">                &quot;firmwareDataFile&quot;: &quot;firmware.json&quot;,</div>
<div class="line">                &quot;status&quot;: &quot;ok&quot;,</div>
<div class="line">                &quot;version&quot; : &quot;motor-fw-1.0&quot;</div>
<div class="line">            }</div>
<div class="line">        },</div>
<div class="line">        {</div>
<div class="line">            &quot;id&quot;: &quot;contoso-motor-serial-00002&quot;,</div>
<div class="line">            &quot;name&quot;: &quot;vacuum-motor&quot;,</div>
<div class="line">            &quot;group&quot;: &quot;motors&quot;,</div>
<div class="line">            &quot;manufacturer&quot;: &quot;contoso&quot;,</div>
<div class="line">            &quot;model&quot;: &quot;virtual-motor&quot;,</div>
<div class="line">            &quot;properties&quot;: {</div>
<div class="line">                &quot;path&quot;: &quot;\/usr\/local\/contoso-devices\/vacuum-1\/motors\/2&quot;,</div>
<div class="line">                &quot;firmwareDataFile&quot;: &quot;firmware.json&quot;,</div>
<div class="line">                &quot;status&quot;: &quot;ok&quot;,</div>
<div class="line">                &quot;version&quot; : &quot;motor-fw-1.0&quot;</div>
<div class="line">            }</div>
<div class="line">        },</div>
<div class="line">        {</div>
<div class="line">            &quot;id&quot;: &quot;contoso-camera-serial-00000&quot;,</div>
<div class="line">            &quot;name&quot;: &quot;front-camera&quot;,</div>
<div class="line">            &quot;group&quot;: &quot;cameras&quot;,</div>
<div class="line">            &quot;manufacturer&quot;: &quot;contoso&quot;,</div>
<div class="line">            &quot;model&quot;: &quot;virtual-camera&quot;,</div>
<div class="line">            &quot;properties&quot;: {</div>
<div class="line">                &quot;path&quot;: &quot;\/usr\/local\/contoso-devices\/vacuum-1\/camera\/0&quot;,</div>
<div class="line">                &quot;firmwareDataFile&quot;: &quot;firmware.json&quot;,</div>
<div class="line">                &quot;status&quot;: &quot;ok&quot;,</div>
<div class="line">                &quot;version&quot; : &quot;camera-fw-1.0&quot;</div>
<div class="line">            }</div>
<div class="line">        },</div>
<div class="line">        {</div>
<div class="line">            &quot;id&quot;: &quot;contoso-camera-serial-00001&quot;,</div>
<div class="line">            &quot;name&quot;: &quot;rear-camera&quot;,</div>
<div class="line">            &quot;group&quot;: &quot;cameras&quot;,</div>
<div class="line">            &quot;manufacturer&quot;: &quot;contoso&quot;,</div>
<div class="line">            &quot;model&quot;: &quot;virtual-camera&quot;,</div>
<div class="line">            &quot;properties&quot;: {</div>
<div class="line">                &quot;path&quot;: &quot;\/usr\/local\/contoso-devices\/vacuum-1\/camera\/1&quot;,</div>
<div class="line">                &quot;firmwareDataFile&quot;: &quot;firmware.json&quot;,</div>
<div class="line">                &quot;status&quot;: &quot;ok&quot;,</div>
<div class="line">                &quot;version&quot; : &quot;camera-fw-1.0&quot;</div>
<div class="line">            }</div>
<div class="line">        }</div>
<div class="line">    ]</div>
<div class="line">}</div>
</div><!-- fragment --><p>Following is a JSON document returned from <code>SelectComponents</code> function *(Based on example Contoso Component Enumerator implementation)*</p>
<p>Input parameter (select <b>motors</b> component group):</p>
<div class="fragment"><div class="line">{</div>
<div class="line">    &quot;group&quot; : &quot;motors&quot;</div>
<div class="line">}</div>
</div><!-- fragment --><p>Output (all components belong to <b>motors</b> group):</p>
<div class="fragment"><div class="line">{</div>
<div class="line">    &quot;components&quot;: [</div>
<div class="line">        {</div>
<div class="line">            &quot;id&quot;: &quot;contoso-motor-serial-00000&quot;,</div>
<div class="line">            &quot;name&quot;: &quot;left-motor&quot;,</div>
<div class="line">            &quot;group&quot;: &quot;motors&quot;,</div>
<div class="line">            &quot;manufacturer&quot;: &quot;contoso&quot;,</div>
<div class="line">            &quot;model&quot;: &quot;virtual-motor&quot;,</div>
<div class="line">            &quot;properties&quot;: {</div>
<div class="line">                &quot;path&quot;: &quot;\/usr\/local\/contoso-devices\/vacuum-1\/motors\/0&quot;,</div>
<div class="line">                &quot;firmwareDataFile&quot;: &quot;firmware.json&quot;,</div>
<div class="line">                &quot;status&quot;: &quot;ok&quot;,</div>
<div class="line">                &quot;version&quot; : &quot;motor-fw-1.0&quot;</div>
<div class="line">            }</div>
<div class="line">        },</div>
<div class="line">        {</div>
<div class="line">            &quot;id&quot;: &quot;contoso-motor-serial-00001&quot;,</div>
<div class="line">            &quot;name&quot;: &quot;right-motor&quot;,</div>
<div class="line">            &quot;group&quot;: &quot;motors&quot;,</div>
<div class="line">            &quot;manufacturer&quot;: &quot;contoso&quot;,</div>
<div class="line">            &quot;model&quot;: &quot;virtual-motor&quot;,</div>
<div class="line">            &quot;properties&quot;: {</div>
<div class="line">                &quot;path&quot;: &quot;\/usr\/local\/contoso-devices\/vacuum-1\/motors\/1&quot;,</div>
<div class="line">                &quot;firmwareDataFile&quot;: &quot;firmware.json&quot;,</div>
<div class="line">                &quot;status&quot;: &quot;ok&quot;,</div>
<div class="line">                &quot;version&quot; : &quot;motor-fw-1.0&quot;</div>
<div class="line">            }</div>
<div class="line">        },</div>
<div class="line">        {</div>
<div class="line">            &quot;id&quot;: &quot;contoso-motor-serial-00002&quot;,</div>
<div class="line">            &quot;name&quot;: &quot;vacuum-motor&quot;,</div>
<div class="line">            &quot;group&quot;: &quot;motors&quot;,</div>
<div class="line">            &quot;manufacturer&quot;: &quot;contoso&quot;,</div>
<div class="line">            &quot;model&quot;: &quot;virtual-motor&quot;,</div>
<div class="line">            &quot;properties&quot;: {</div>
<div class="line">                &quot;path&quot;: &quot;\/usr\/local\/contoso-devices\/vacuum-1\/motors\/2&quot;,</div>
<div class="line">                &quot;firmwareDataFile&quot;: &quot;firmware.json&quot;,</div>
<div class="line">                &quot;status&quot;: &quot;ok&quot;,</div>
<div class="line">                &quot;version&quot; : &quot;motor-fw-1.0&quot;</div>
<div class="line">            }</div>
<div class="line">        }</div>
<div class="line">    ]</div>
<div class="line">}</div>
</div><!-- fragment --><p>Input parameter (select a single component named <b>hostfw</b>):</p>
<div class="fragment"><div class="line">{</div>
<div class="line">    &quot;name&quot; : &quot;hostfw&quot;</div>
<div class="line">}</div>
</div><!-- fragment --><p>Output (<b>hostfw</b> component):</p>
<div class="fragment"><div class="line">{</div>
<div class="line">    &quot;components&quot;: [</div>
<div class="line">        {</div>
<div class="line">            &quot;id&quot;: &quot;hostfw&quot;,</div>
<div class="line">            &quot;name&quot;: &quot;hostfw&quot;,</div>
<div class="line">            &quot;group&quot;: &quot;firmware&quot;,</div>
<div class="line">            &quot;manufacturer&quot;: &quot;contoso&quot;,</div>
<div class="line">            &quot;model&quot;: &quot;virtual-firmware&quot;,</div>
<div class="line">            &quot;properties&quot;: {</div>
<div class="line">                &quot;path&quot;: &quot;\/usr\/local\/contoso-devices\/vacuum-1\/hostfw&quot;,</div>
<div class="line">                &quot;firmwareDataFile&quot;: &quot;firmware.json&quot;,</div>
<div class="line">                &quot;status&quot;: &quot;ok&quot;,</div>
<div class="line">                &quot;version&quot; : &quot;host-fw-1.0&quot;</div>
<div class="line">            }</div>
<div class="line">        }</div>
<div class="line">    ]</div>
<div class="line">}</div>
</div><!-- fragment --><p><b>Note:</b> The above example demonstrated that, if needed, it's possible to send a newer update to any instance of a component when selected by <code>name</code> property. <br  />
 For example, deploy <code>motor-fw-2.0</code> update to <code>vacuum-motor</code> while continue using <code>motor-fw-1.0</code> on <code>left-motor</code> and <code>right-motor</code>.</p>
<h1><a class="anchor" id="autotoc_md70"></a>
component-inventory.json</h1>
<p>The example implementation shown above for Contoso Component Enumerator will read the device-specific components' information from the <code>component-inventory.json</code> file. Please note that this is only for demonstration purposes. <br  />
</p>
<p><b>In the production scenario</b>, some properties, such as <code>id</code>, <code>manufacturer</code>, <code>model</code>, should be retrieved directly from the actual components. <br  />
</p>
<p><code>name</code> and <code>group</code> properties are usually defined by the device builder. These values should never change, once defined. The <code>name</code> property must be unique within the device. <br  />
</p>
<h1><a class="anchor" id="autotoc_md71"></a>
Example component-inventory.json file</h1>
<p>Note that the content in this file looks almost the same as the returned value from <code>GetAllComponents</code> function. However, <code>ComponentInfo</code> in this file doesn't contain <code>version</code> and <code>status</code> properties. These properties will be populated at runtime, by the Component Enumerator.</p>
<p>For example, for <code>hostfw</code>, the value of property <code>properties.version</code> will be populate with value from the specified (mock) <code>firmwareDataFile</code> (<code>/usr/local/contoso-devices/vacuum-1/hostfw/firmware.json</code>)</p>
<div class="fragment"><div class="line">{</div>
<div class="line">    &quot;components&quot;: [</div>
<div class="line">        {</div>
<div class="line">            &quot;id&quot;: &quot;hostfw&quot;,</div>
<div class="line">            &quot;name&quot;: &quot;hostfw&quot;,</div>
<div class="line">            &quot;group&quot;: &quot;firmware&quot;,</div>
<div class="line">            &quot;manufacturer&quot;: &quot;contoso&quot;,</div>
<div class="line">            &quot;model&quot;: &quot;virtual-firmware&quot;,</div>
<div class="line">            &quot;properties&quot;: {</div>
<div class="line">                &quot;path&quot;: &quot;\/usr\/local\/contoso-devices\/vacuum-1\/hostfw&quot;,</div>
<div class="line">                &quot;firmwareDataFile&quot;: &quot;firmware.json&quot;,</div>
<div class="line">            }</div>
<div class="line">        },</div>
<div class="line">        {</div>
<div class="line">            &quot;id&quot;: &quot;bootfs&quot;,</div>
<div class="line">            &quot;name&quot;: &quot;bootfs&quot;,</div>
<div class="line">            &quot;group&quot;: &quot;boot-image&quot;,</div>
<div class="line">            &quot;manufacturer&quot;: &quot;contoso&quot;,</div>
<div class="line">            &quot;model&quot;: &quot;virtual-disk&quot;,</div>
<div class="line">            &quot;properties&quot;: {</div>
<div class="line">                &quot;path&quot;: &quot;\/usr\/local\/contoso-devices\/vacuum-1\/bootfs&quot;,</div>
<div class="line">                &quot;firmwareDataFile&quot;: &quot;diskimage.json&quot;,</div>
<div class="line">            }</div>
<div class="line">        },</div>
<div class="line">        {</div>
<div class="line">            &quot;id&quot;: &quot;rootfs&quot;,</div>
<div class="line">            &quot;name&quot;: &quot;rootfs&quot;,</div>
<div class="line">            &quot;group&quot;: &quot;os-image&quot;,</div>
<div class="line">            &quot;manufacturer&quot;: &quot;contoso&quot;,</div>
<div class="line">            &quot;model&quot;: &quot;virtual-os&quot;,</div>
<div class="line">            &quot;properties&quot;: {</div>
<div class="line">                &quot;path&quot;: &quot;\/usr\/local\/contoso-devices\/vacuum-1\/rootfs&quot;,</div>
<div class="line">                &quot;firmwareDataFile&quot;: &quot;diskimage.json&quot;,</div>
<div class="line">            }</div>
<div class="line">        },</div>
<div class="line">        {</div>
<div class="line">            &quot;id&quot;: &quot;contoso-motor-serial-00000&quot;,</div>
<div class="line">            &quot;name&quot;: &quot;left-motor&quot;,</div>
<div class="line">            &quot;group&quot;: &quot;motors&quot;,</div>
<div class="line">            &quot;manufacturer&quot;: &quot;contoso&quot;,</div>
<div class="line">            &quot;model&quot;: &quot;virtual-motor&quot;,</div>
<div class="line">            &quot;properties&quot;: {</div>
<div class="line">                &quot;path&quot;: &quot;\/usr\/local\/contoso-devices\/vacuum-1\/motors\/0&quot;,</div>
<div class="line">                &quot;firmwareDataFile&quot;: &quot;firmware.json&quot;,</div>
<div class="line">            }</div>
<div class="line">        },</div>
<div class="line">        {</div>
<div class="line">            &quot;id&quot;: &quot;contoso-motor-serial-00001&quot;,</div>
<div class="line">            &quot;name&quot;: &quot;right-motor&quot;,</div>
<div class="line">            &quot;group&quot;: &quot;motors&quot;,</div>
<div class="line">            &quot;manufacturer&quot;: &quot;contoso&quot;,</div>
<div class="line">            &quot;model&quot;: &quot;virtual-motor&quot;,</div>
<div class="line">            &quot;properties&quot;: {</div>
<div class="line">                &quot;path&quot;: &quot;\/usr\/local\/contoso-devices\/vacuum-1\/motors\/1&quot;,</div>
<div class="line">                &quot;firmwareDataFile&quot;: &quot;firmware.json&quot;,</div>
<div class="line">            }</div>
<div class="line">        },</div>
<div class="line">        {</div>
<div class="line">            &quot;id&quot;: &quot;contoso-motor-serial-00002&quot;,</div>
<div class="line">            &quot;name&quot;: &quot;vacuum-motor&quot;,</div>
<div class="line">            &quot;group&quot;: &quot;motors&quot;,</div>
<div class="line">            &quot;manufacturer&quot;: &quot;contoso&quot;,</div>
<div class="line">            &quot;model&quot;: &quot;virtual-motor&quot;,</div>
<div class="line">            &quot;properties&quot;: {</div>
<div class="line">                &quot;path&quot;: &quot;\/usr\/local\/contoso-devices\/vacuum-1\/motors\/2&quot;,</div>
<div class="line">                &quot;firmwareDataFile&quot;: &quot;firmware.json&quot;,</div>
<div class="line">            }</div>
<div class="line">        },</div>
<div class="line">        {</div>
<div class="line">            &quot;id&quot;: &quot;contoso-camera-serial-00000&quot;,</div>
<div class="line">            &quot;name&quot;: &quot;front-camera&quot;,</div>
<div class="line">            &quot;group&quot;: &quot;cameras&quot;,</div>
<div class="line">            &quot;manufacturer&quot;: &quot;contoso&quot;,</div>
<div class="line">            &quot;model&quot;: &quot;virtual-camera&quot;,</div>
<div class="line">            &quot;properties&quot;: {</div>
<div class="line">                &quot;path&quot;: &quot;\/usr\/local\/contoso-devices\/vacuum-1\/camera\/0&quot;,</div>
<div class="line">                &quot;firmwareDataFile&quot;: &quot;firmware.json&quot;,</div>
<div class="line">            }</div>
<div class="line">        },</div>
<div class="line">        {</div>
<div class="line">            &quot;id&quot;: &quot;contoso-camera-serial-00001&quot;,</div>
<div class="line">            &quot;name&quot;: &quot;rear-camera&quot;,</div>
<div class="line">            &quot;group&quot;: &quot;cameras&quot;,</div>
<div class="line">            &quot;manufacturer&quot;: &quot;contoso&quot;,</div>
<div class="line">            &quot;model&quot;: &quot;virtual-camera&quot;,</div>
<div class="line">            &quot;properties&quot;: {</div>
<div class="line">                &quot;path&quot;: &quot;\/usr\/local\/contoso-devices\/vacuum-1\/camera\/1&quot;,</div>
<div class="line">                &quot;firmwareDataFile&quot;: &quot;firmware.json&quot;,</div>
<div class="line">            }</div>
<div class="line">        }</div>
<div class="line">    ]</div>
<div class="line">}</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md72"></a>
Example Source Codes</h2>
<p>This example is written in <code>C++</code>. You can choose to use <code>C</code> if desired.</p>
<ul>
<li><a href="../contoso_component_enumerator/CMakeLists.txt">CMakeLists.txt</a></li>
<li><a href="../contoso_component_enumerator/contoso_component_enumerator.cpp">contoso_component_enumerator.cpp</a></li>
<li><a href="../../inc/aduc/../../../inc/aduc/component_enumerator_extension.hpp">inc/aduc/component_enumerator_extension.hpp</a></li>
</ul>
<h2><a class="anchor" id="autotoc_md73"></a>
Example Proxy Update</h2>
<p>See Proxy Update Demo for various sample updates for components connected to the Contoso Virtual Vacuum device. </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.17
</small></address>
</body>
</html>
